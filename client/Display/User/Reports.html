<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Boxicons -->
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
	<!-- My CSS -->
	<link rel="stylesheet" href="Reports.css">

	<title>User</title>

	<!-- Add in the head section -->
	<script src="js/notifications.js"></script>

	<style>
		/* Modal styles */
		.modal {
			display: none;
			position: fixed;
			z-index: 1000;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.7);
			display: flex;
			justify-content: center;
			align-items: center;
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.3s ease, visibility 0.3s ease;
		}

		.modal.active {
			opacity: 1;
			visibility: visible;
		}

		.modal-content {
			background-color: #fff;
			padding: 30px;
			border-radius: 10px;
			left: 150px;
			max-width: 900px;
			width: 90%;
			position: relative;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
			transform: scale(0.7);
			opacity: 0;
			transition: transform 0.3s ease, opacity 0.3s ease;
		}

		.modal.active .modal-content {
			transform: scale(1);
			opacity: 1;
		}

		.close {
			position: absolute;
			right: 20px;
			top: 15px;
			font-size: 28px;
			cursor: pointer;
			color: #333;
		}

		.close:hover {
			color: #000;
		}

		.modal-cards {
			display: flex;
			gap: 30px;
		}

		.card {
			flex: 1;
			background-color: #f9f9f9;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
		}

		.card h3 {
			margin-bottom: 15px;
			color: #333;
			font-size: 1.2em;
		}

		.image-container {
			text-align: center;
			margin-bottom: 15px;
		}

		.image-container img {
			max-width: 100%;
			height: auto;
			border-radius: 8px;
		}

		p {
			margin: 10px 0;
			color: #555;
			font-size: 0.95em;
		}

		p strong {
			color: #333;
		}

		/* Responsive adjustments */
		@media (max-width: 768px) {
			.modal-cards {
				flex-direction: column;
			}
		}
	</style>
</head>
<body>


	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			<img src="img/NSTP_LOGO.png" alt="Admin Logo" class="brand" />
			<span class="text">User</span>
		</a>
		<ul class="side-menu top">
			<li>
				<a href="Dashboard.html">
					<i class='bx bxs-dashboard'></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="Requestpage.html">
					<i class='bx bxs-shopping-bag-alt' ></i>
					<span class="text">Request</span>
				</a>
			</li>
			<li>
				<a href="Borroweditems.html">
					<i class='bx bxs-message-square-add' ></i>
					<span class="text">Borrowed Items</span>
				</a>
			</li>
			<li>
				<a href="Reports.html">
					<i class='bx bxs-message-dots' ></i>
					<span class="text">Reports</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<!-- <li>
				<a href="#">
					<i class='bx bxs-cog' ></i>
					<span class="text">Settings</span>
				</a>
			</li> -->
			<li>
				<a href="../login/login.html" class="logout">
					<i class='bx bxs-log-out-circle' ></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->



	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu' ></i>
			<a href="#" class="nav-link">Categories</a>
			<form action="#">
				<div class="form-input">
					<input type="search" placeholder="Search...">
					<button type="submit" class="search-btn"><i class='bx bx-search' ></i></button>
				</div>
			</form>
			<input type="checkbox" id="switch-mode" hidden>
			<label for="switch-mode" class="switch-mode"></label>
			<a href="Notification.html" class="notification">
				<i class='bx bxs-bell'></i>
				<span class="badge" id="notification-count">0</span>
			</a>
			<a href="StaffProfile.html" class="profile">
				<img src="img/Screen-Shot-2024-06-11-at-11.54.30-AM-e1718634535872.webp">
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
			<div class="head-title">
				<div class="left">
					<h1>Reports</h1>
					<ul class="breadcrumb">
						<li>
							<a href="#">Reports</a>
						</li>
						<li><i class='bx bx-chevron-right' ></i></li>
						<li>
							<a class="active" href="Dashboard.html">Home</a>
						</li>
					</ul>
				</div>
				<!-- <a href="#" class="btn-download">
					<i class='bx bxs-cloud-download' ></i>
					<span class="text">Download PDF</span>
				</a> -->
			</div>

			<div class="table-data">
				<div class="pending-requests">
					<div class="head">
						<h3>Generated Reports</h3>
						<i class='bx bx-filter'></i>
					</div>
					<div class="order">
						<table>
							<thead>
								<tr>
									<th>Item Description</th>
									<th>Status</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>
										<img src="img/people.png" alt="User Image">
										<p>Epson 705HD Powerlite Home Cinema LCD Projector</p>
									</td>
                                        <td><span class="status R1">Returned</span></td>
										<td>
											<a href="#" class="view-button">
											<span class="status R2">view</span>
											</a>
										</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>			
				<!-- <div class="todo">
					<div class="head">
						<h3>Todos</h3>
						<i class='bx bx-plus' ></i>
						<i class='bx bx-filter' ></i>
					</div>
					<ul class="todo-list">
						<li class="completed">
							<p>Todo List</p>
							<i class='bx bx-dots-vertical-rounded' ></i>
						</li>
						<li class="completed">
							<p>Todo List</p>
							<i class='bx bx-dots-vertical-rounded' ></i>
						</li>
						<li class="not-completed">
							<p>Todo List</p>
							<i class='bx bx-dots-vertical-rounded' ></i>
						</li>
						<li class="completed">
							<p>Todo List</p>
							<i class='bx bx-dots-vertical-rounded' ></i>
						</li>
						<li class="not-completed">
							<p>Todo List</p>
							<i class='bx bx-dots-vertical-rounded' ></i>
						</li>
					</ul>
				</div> -->
			</div>
		</main>
		<!-- MAIN -->
	</section>
	<!-- CONTENT -->
	

	<!-- Modal Structure -->
	<div id="itemModal" class="modal">
		<div class="modal-content">
			<span class="close">&times;</span>
			<h2 style="text-align: center; color: #333; margin-bottom: 20px;">Item Details</h2>
			<div class="modal-cards">
				<div class="card">
					<h3>Borrower Information</h3>
					<div class="image-container">
						<img src="img/Screen-Shot-2024-06-11-at-11.54.30-AM-e1718634535872.webp" alt="Borrower Image" id="borrowerImage">
					</div>
					<p><strong>Borrower Name:</strong> <span id="borrowerName"></span></p>
					<p><strong>Borrower ID:</strong> <span id="borrowerId"></span></p>
				</div>
				<div class="card">
					<h3>Item Information</h3>
					<div class="image-container">
						<img src="img/DLP.webp" alt="Item Image" id="itemImage">
					</div>
					<p><strong>Item ID:</strong> <span id="itemId"></span></p>
					<p><strong>Item Name:</strong> <span id="itemName"></span></p>
					<p><strong>Item Description:</strong> <span id="itemDescription"></span></p>
					<p><strong>Date and Time Booked:</strong> <span id="itemDateTime"></span></p>
					<p><strong>Date and Time Request Accepted:</strong> <span id="requestAccepted"></span></p>
					<p><strong>Date and Time Item Returned:</strong> <span id="itemReturned"></span></p>
				</div>
			</div>
		</div>
	</div>

	<script src="script.js"></script>
	<script>
		// Get the modal
		var modal = document.getElementById("itemModal");

		// Get the <span> element that closes the modal
		var span = document.getElementsByClassName("close")[0];

		// When the user clicks on <span> (x), close the modal
		span.onclick = function() {
			modal.classList.remove('active');
		}

		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function(event) {
			if (event.target == modal) {
				modal.classList.remove('active');
			}
		}

		// Toggle filter options visibility
		document.querySelector('.bx-filter').addEventListener('click', function(event) {
			event.preventDefault();
			const filterOptions = document.getElementById('filterOptions');
			filterOptions.style.display = filterOptions.style.display === 'none' ? 'block' : 'none';
		});

		// Function to sort the table
		function sortTable(columnIndex, order) {
			const table = document.querySelector('.order table');
			const tbody = table.tBodies[0];
			const rows = Array.from(tbody.rows);

			rows.sort((a, b) => {
				const cellA = a.cells[columnIndex].textContent.trim();
				const cellB = b.cells[columnIndex].textContent.trim();

				if (order === 'asc') {
					return cellA.localeCompare(cellB);
				} else {
					return cellB.localeCompare(cellA);
				}
			});

			// Append sorted rows to the table body
			rows.forEach(row => tbody.appendChild(row));

			// Reattach event listeners to the view buttons
			attachViewButtonListeners();
		}

		// Function to open the modal and populate it with data
		function openModal(itemId, itemName, borrowerName, borrowerId, itemDescription, itemDateTime, requestAccepted, itemReturned) {
			document.getElementById("itemId").textContent = itemId;
			document.getElementById("itemName").textContent = itemName;
			document.getElementById("borrowerName").textContent = borrowerName;
			document.getElementById("borrowerId").textContent = borrowerId;
			document.getElementById("itemDescription").textContent = itemDescription;
			document.getElementById("itemDateTime").textContent = itemDateTime;
			document.getElementById("requestAccepted").textContent = requestAccepted;
			document.getElementById("itemReturned").textContent = itemReturned;
			modal.classList.add('active');
		}

		// Function to attach event listeners to the view buttons
		function attachViewButtonListeners() {
			document.querySelectorAll('.view-button').forEach(function(viewButton) {
				viewButton.addEventListener('click', function(event) {
					event.preventDefault();
					// Example data, replace with actual data retrieval logic
					openModal(
						'12345', 
						'Epson 705HD Powerlite Home Cinema LCD Projector', 
						'John Doe', 
						'67890', 
						'High-quality projector for home cinema', 
						'2024-06-11 11:54:30', 
						'2024-06-10 10:00:00', 
						'2024-06-12 15:00:00'
					);
				});
			});
		}

		// Initial attachment of event listeners
		attachViewButtonListeners();

		// Function to toggle sidebar and background color
		function toggleSidebar() {
			const sidebar = document.getElementById('sidebar');
			const content = document.getElementById('content');
			const isExpanded = sidebar.classList.toggle('expanded');
			
			// Toggle the background color class
			if (isExpanded) {
				content.classList.add('sidebar-expanded');
			} else {
				content.classList.remove('sidebar-expanded');
			}
		}

		// Add event listener to the menu icon
		document.querySelector('.bx-menu').addEventListener('click', toggleSidebar);

		function updateNotificationCount() {
			fetch('/api/notifications/count')
				.then(response => response.json())
				.then(data => {
					const notificationCountElement = document.getElementById('notification-count');
					notificationCountElement.textContent = data.count;
				})
				.catch(error => console.error('Error fetching notification count:', error));
		}

		// Call the function to update the notification count when the page loads
		document.addEventListener('DOMContentLoaded', updateNotificationCount);

		// Optionally, set an interval to update the count periodically
		setInterval(updateNotificationCount, 60000); // Update every 60 seconds
	</script>
</body>
</html>