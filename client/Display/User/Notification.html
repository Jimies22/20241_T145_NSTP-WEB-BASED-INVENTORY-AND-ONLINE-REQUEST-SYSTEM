<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Boxicons -->
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
	<!-- My CSS -->
	<link rel="stylesheet" href="Notification.css">

	<title>User</title>
	<style>
		.notification-list {
			max-width: 800px;
			margin: 20px auto;
		}

		.notification-item {
			padding: 15px;
			margin-bottom: 10px;
			border-radius: 8px;
			background: #fff;
			box-shadow: 0 2px 4px rgba(0,0,0,0.1);
			display: flex;
			align-items: center;
			cursor: pointer;
		}

		.notification-item.unread {
			background: #f0f7ff;
		}

		.notification-icon {
			margin-right: 15px;
			font-size: 24px;
		}

		.notification-content {
			flex-grow: 1;
		}

		.notification-title {
			font-weight: bold;
			margin-bottom: 5px;
		}

		.notification-message {
			color: #666;
		}

		.notification-time {
			color: #999;
			font-size: 0.8em;
		}

		/* Status-specific colors */
		.booking .notification-icon { color: #3498db; }
		.accepted .notification-icon { color: #2ecc71; }
		.canceled .notification-icon { color: #e74c3c; }
		.returned .notification-icon { color: #f1c40f; }

		.no-notifications {
			text-align: center;
			padding: 40px;
			color: #666;
		}

		.no-notifications i {
			font-size: 48px;
			margin-bottom: 10px;
			color: #999;
		}

		.notification-item {
			transition: background-color 0.3s ease;
		}

		.notification-item:hover {
			background-color: #f5f5f5;
		}

		.notification-item.unread {
			border-left: 4px solid #3498db;
		}

		.notification-item .notification-time {
			font-size: 0.8em;
			color: #999;
			margin-top: 5px;
		}
	</style>
</head>
<body>


	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			<img src="img/NSTP_LOGO.png" alt="Admin Logo" class="brand" />
			<span class="text">User</span>
		</a>
		<ul class="side-menu top">
            <li>
				<a href="Dashboard.html">
					<i class='bx bxs-dashboard'></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="Requestpage.html">
					<i class='bx bxs-shopping-bag-alt' ></i>
					<span class="text">Request</span>
				</a>
			</li>
            <li>
				<a href="Borroweditems.html">
					<i class='bx bxs-book'></i>
					<span class="text">Borrowed Items</span>
				</a>
			</li>
			<li>
				<a href="Reports.html">
                    <i class='bx bxs-report' ></i>
					<span class="text">Reports</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<!-- <li>
				<a href="#">
					<i class='bx bxs-cog' ></i>
					<span class="text">Settings</span>
				</a>
			</li> -->
			<li>
				<a href="../login/login.html" class="logout">
					<i class='bx bxs-log-out-circle' ></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->



	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu' ></i>
			<a href="#" class="nav-link">Categories</a>
			<form action="#">
				<div class="form-input">
					<input type="search" placeholder="Search...">
					<button type="submit" class="search-btn"><i class='bx bx-search' ></i></button>
				</div>
			</form>
			<input type="checkbox" id="switch-mode" hidden>
			<label for="switch-mode" class="switch-mode"></label>
			<a href="#" class="notification">
				<i class='bx bxs-bell' ></i>
				<span class="num">8</span>
			</a>
			<a href="#" class="profile">
				<img src="img/Screen-Shot-2024-06-11-at-11.54.30-AM-e1718634535872.webp">
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
			<div class="head-title">
				<div class="left">
					<h1>Notifications</h1>
					<ul class="breadcrumb">
						<!-- ... existing breadcrumb ... -->
					</ul>
				</div>
				<div class="right">
					<button class="btn-download" onclick="markAllNotificationsAsRead()">
						<i class='bx bx-check-double'></i>
						<span class="text">Mark all as read</span>
					</button>
				</div>
			</div>

			<div class="notification-list" id="notificationList">
				<!-- Notifications will be inserted here dynamically -->
			</div>
		</main>
		<!-- MAIN -->
	</section>
	<!-- CONTENT -->
	

	<script>
	document.addEventListener('DOMContentLoaded', function() {
		// Get notifications from localStorage
		const notifications = JSON.parse(localStorage.getItem('notifications')) || [];

		function createNotificationElement(notification) {
			const timeAgo = getTimeAgo(notification.timestamp);
			return `
				<div class="notification-item ${notification.read ? '' : 'unread'} ${notification.type}">
					<div class="notification-icon">
						${getIconForType(notification.type)}
					</div>
					<div class="notification-content">
						<div class="notification-title">${notification.title}</div>
						<div class="notification-message">${notification.message}</div>
						<div class="notification-time">${timeAgo}</div>
					</div>
				</div>
			`;
		}

		function getIconForType(type) {
			const icons = {
				'booking': '<i class="bx bx-package"></i>',
				'canceled': '<i class="bx bx-x-circle"></i>',
				'returned': '<i class="bx bx-check-circle"></i>',
				'accepted': '<i class="bx bx-check-double"></i>',
				'rejected': '<i class="bx bx-x"></i>',
				'cancel-request': '<i class="bx bx-block"></i>'
			};
			return icons[type] || '<i class="bx bx-bell"></i>';
		}

		function getTimeAgo(timestamp) {
			const now = new Date();
			const past = new Date(timestamp);
			const diffInSeconds = Math.floor((now - past) / 1000);

			if (diffInSeconds < 60) {
				return 'Just now';
			} else if (diffInSeconds < 3600) {
				const minutes = Math.floor(diffInSeconds / 60);
				return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
			} else if (diffInSeconds < 86400) {
				const hours = Math.floor(diffInSeconds / 3600);
				return `${hours} hour${hours > 1 ? 's' : ''} ago`;
			} else {
				const days = Math.floor(diffInSeconds / 86400);
				return `${days} day${days > 1 ? 's' : ''} ago`;
			}
		}

		function displayNotifications() {
			const notificationList = document.getElementById('notificationList');
			if (notifications.length === 0) {
				notificationList.innerHTML = `
					<div class="no-notifications">
						<i class='bx bx-bell-off'></i>
						<p>No notifications yet</p>
					</div>
				`;
			} else {
				notificationList.innerHTML = notifications
					.map(notification => createNotificationElement(notification))
					.join('');
			}
		}

		// Function to mark all notifications as read
		window.markAllNotificationsAsRead = function() {
			notifications.forEach(notification => notification.read = true);
			localStorage.setItem('notifications', JSON.stringify(notifications));
			displayNotifications();
			updateNotificationCount();
		};

		function updateNotificationCount() {
			const unreadCount = notifications.filter(n => !n.read).length;
			const numElement = document.querySelector('.notification .num');
			if (unreadCount > 0) {
				numElement.style.display = 'block';
				numElement.textContent = unreadCount;
			} else {
				numElement.style.display = 'none';
			}
		}

		// Add click event listeners to notification items
		document.getElementById('notificationList').addEventListener('click', function(e) {
			const notificationItem = e.target.closest('.notification-item');
			if (notificationItem) {
				const index = Array.from(notificationItem.parentElement.children).indexOf(notificationItem);
				if (index !== -1 && !notifications[index].read) {
					notifications[index].read = true;
					localStorage.setItem('notifications', JSON.stringify(notifications));
					notificationItem.classList.remove('unread');
					updateNotificationCount();
				}
			}
		});

		// Initial display
		displayNotifications();
		updateNotificationCount();
	});
	</script>
</body>
</html>